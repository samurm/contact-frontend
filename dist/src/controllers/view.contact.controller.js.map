{"version":3,"sources":["controllers/view.contact.controller.js"],"names":["ViewControllerContact","_viewContact","_fetchService","_serviceContact","_serviceRegexp","addClickPhones","buttonAddClickCreateContact","addClickInputImage","fieldsRegExp","addEventsDragDropImage","ICON_ADD_PHONES","addEventListener","EVENT_LISTENER","CLICK","addContainerPhone","bind","BUTTON_CREATE_CONTACT","createContact","INPUT_IMAGE","CHANGE","file","files","changeImage","NAME_CONTACT","BLUR","validateName","SURNAME_CONTACT","validateSurname","AGE_CONTACT","validateAge","PHONE_CONTACT","validatePhone","IMAGE_CONTACT","DRAG_OVER","overImage","DROP","e","stopPropagation","preventDefault","dataTransfer","isValidName","value","setOkStatus","setKOStatus","isValidSurname","isValidAge","img","reader","FileReader","onloadend","src","result","readAsDataURL","MODEL","CAMERA","data","takeDataContactDOM","CONTACT","DEFAULT","editContainerContact","TEXT_HTML","MAN","cleanContainerButtonContact","addContact","createContainerContact","fetchCreateContact","URL","CONTACTS","CREATE","FETCH_VERBS","POST","then","id","document","getElementById","selectContact","valueInputPhone","divRow","createElementAndAddClass","ELEMENTS_HTML","DIV","STYLE","ROW","PADDING_TOP_NORMAL","colLeft","COL_SM_4","colMiddle","COL_SM_6","inputPhone","createElementAndAddClassId","INPUT","FORM_CONTROL","COMPONENT_HTML","ID_PHONE_INPUT","phoneInput","colRight","COL_SM_2","iconSubtractPhone","SPAN","GLYPHICON","GLYPHICON_MINUS","ICON","remove","appendChild","appendChildElements","CONTAINER_PHONES","field","isValidPhone","setStatus","FONTAWESOME","OK","KO","status","classList","add","idContact","photoContact","nameContact","surnameContact","ageContact","phonesContactContainer","children","phonesContact","i","max","length","join","genderContact","GENDER_CONTACT","_id","photo","name","surname","age","phone","gender"],"mappings":"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","sourcesContent":["class ViewControllerContact{\n    constructor(_viewContact, _fetchService ,_serviceContact, _serviceRegexp){\n        this._viewContact = _viewContact;\n        this._fetchService = _fetchService;\n        this._serviceContact = _serviceContact;\n        this._serviceRegexp = _serviceRegexp;\n        this.addClickPhones();\n        this.buttonAddClickCreateContact();\n        this.addClickInputImage();\n        this.fieldsRegExp();\n        this.addEventsDragDropImage();\n    }\n\n    addClickPhones(){\n        this._viewContact.ICON_ADD_PHONES.addEventListener(EVENT_LISTENER.CLICK, function(){\n            this.addContainerPhone(\"\");\n        }.bind(this));\n    }\n\n    buttonAddClickCreateContact(){\n        this._viewContact.BUTTON_CREATE_CONTACT.addEventListener(EVENT_LISTENER.CLICK, this.createContact.bind(this));\n    }\n\n    addClickInputImage(){\n        this._viewContact.INPUT_IMAGE.addEventListener(EVENT_LISTENER.CHANGE, function(){\n            const file = this._viewContact.INPUT_IMAGE.files[0];\n            this.changeImage(file);\n        }.bind(this));\n    }\n\n    fieldsRegExp(){\n        this._viewContact.NAME_CONTACT.addEventListener(EVENT_LISTENER.BLUR, this.validateName.bind(this));\n        this._viewContact.SURNAME_CONTACT.addEventListener(EVENT_LISTENER.BLUR, this.validateSurname.bind(this));\n        this._viewContact.AGE_CONTACT.addEventListener(EVENT_LISTENER.BLUR, this.validateAge.bind(this));\n        this._viewContact.PHONE_CONTACT.addEventListener(EVENT_LISTENER.BLUR, function(){\n            this.validatePhone(this._viewContact.PHONE_CONTACT);\n        }.bind(this));\n    }\n\n    addEventsDragDropImage(){\n        this._viewContact.IMAGE_CONTACT.addEventListener(EVENT_LISTENER.DRAG_OVER, this.overImage);\n        this._viewContact.IMAGE_CONTACT.addEventListener(EVENT_LISTENER.DROP, function(e){\n            e.stopPropagation();\n            e.preventDefault();\n            const files = e.dataTransfer.files;\n            const file = files[0];\n            this.changeImage(file);\n        }.bind(this));\n    }\n\n    overImage(e){\n        e.stopPropagation();\n        e.preventDefault();\n    }  \n\n    validateName(){\n        return this._serviceRegexp.isValidName(this._viewContact.NAME_CONTACT.value)\n            ? this.setOkStatus(this._viewContact.NAME_CONTACT)\n            : this.setKOStatus(this._viewContact.NAME_CONTACT);\n    }\n\n    validateSurname(){\n        return this._serviceRegexp.isValidSurname(this._viewContact.SURNAME_CONTACT.value)\n            ? this.setOkStatus(this._viewContact.SURNAME_CONTACT)\n            : this.setKOStatus(this._viewContact.SURNAME_CONTACT);\n    }\n\n    validateAge(){\n        return this._serviceRegexp.isValidAge(this._viewContact.AGE_CONTACT.value)\n            ? this.setOkStatus(this._viewContact.AGE_CONTACT)\n            : this.setKOStatus(this._viewContact.AGE_CONTACT);\n    }\n\n    changeImage(file){\n        const img = this._viewContact.IMAGE_CONTACT;\n        const reader  = new FileReader();\n \n        reader.onloadend = function () {\n            img.src = reader.result;\n        }\n \n        if (file) {\n            reader.readAsDataURL(file);\n        } else {\n            img.src = MODEL.CAMERA;\n        }\n    }\n\n\n    //viewContact *GLOBAL\n    createContact(){\n        const data = this.takeDataContactDOM(CONTACT.DEFAULT);\n        this.editContainerContact(\"\", \"\", \"\", \"\", [\"\"], TEXT_HTML.MAN);\n        this.cleanContainerButtonContact();\n        this._serviceContact.addContact(data);\n        this.createContainerContact(data);\n        this._fetchService.fetchCreateContact(URL.CONTACTS+URL.CREATE, FETCH_VERBS.POST, data).then(id => {\n            this._viewContact.document.getElementById(id).addEventListener(EVENT_LISTENER.CLICK, function(){\n                this.selectContact(id);\n            }.bind(this));\n        });\n    }\n\n    //*GLOBAL\n    addContainerPhone(valueInputPhone){\n        const divRow = this.createElementAndAddClass(ELEMENTS_HTML.DIV, [STYLE.ROW, STYLE.PADDING_TOP_NORMAL]);\n        const colLeft = this.createElementAndAddClass(ELEMENTS_HTML.DIV, [STYLE.COL_SM_4]);\n        const colMiddle = this.createElementAndAddClass(ELEMENTS_HTML.DIV, [STYLE.COL_SM_6]);\n        const inputPhone = this.createElementAndAddClassId(ELEMENTS_HTML.INPUT, [STYLE.FORM_CONTROL], COMPONENT_HTML.ID_PHONE_INPUT+this._serviceContact.phoneInput);\n        inputPhone.value = valueInputPhone;\n        inputPhone.addEventListener(EVENT_LISTENER.BLUR, function(){\n            this.validatePhone(inputPhone);\n        }.bind(this));\n        const colRight = this.createElementAndAddClass(ELEMENTS_HTML.DIV, [STYLE.COL_SM_2]);\n        const iconSubtractPhone = this.createElementAndAddClass(ELEMENTS_HTML.SPAN, [STYLE.GLYPHICON, STYLE.GLYPHICON_MINUS, STYLE.ICON]);\n        iconSubtractPhone.addEventListener(EVENT_LISTENER.CLICK, function(){ \n            divRow.remove();\n            this._serviceContact.phoneInput -= 1;\n        }.bind(this));\n        colMiddle.appendChild(inputPhone);\n        colRight.appendChild(iconSubtractPhone);\n        this.appendChildElements(divRow, [colLeft, colMiddle, colRight]);\n        this._viewContact.CONTAINER_PHONES.appendChild(divRow);\n        this._serviceContact.phoneInput += 1;\n    }\n\n    //*GLOBAL\n    validatePhone(field){\n        return this._serviceRegexp.isValidPhone(field.value)\n            ? this.setOkStatus(field)\n            : this.setKOStatus(field);\n    }\n\n    setOkStatus(field) {\n        this.setStatus(field, FONTAWESOME.OK);\n        return true;\n    }\n    \n    setKOStatus(field) {\n        this.setStatus(field, FONTAWESOME.KO);\n        return false;\n    }\n\n    setStatus(field, status) {\n        field.classList = status;\n        field.classList.add(STYLE.FORM_CONTROL);\n    };\n\n    //*GLOBAL\n    takeDataContactDOM(idContact){\n    const photoContact = this._viewContact.IMAGE_CONTACT.src;\n    const nameContact = this._viewContact.NAME_CONTACT.value;\n    const surnameContact = this._viewContact.SURNAME_CONTACT.value;\n    const ageContact = this._viewContact.AGE_CONTACT.value;\n    const phonesContactContainer = this._viewContact.CONTAINER_PHONES.children;\n    let phonesContact = [];\n    for(let i=0, max=phonesContactContainer; i<max.length; ++i){\n        phonesContact = [...phonesContact, this._viewContact.document.getElementById(COMPONENT_HTML.ID_PHONE_INPUT+i).value];\n    }\n    phonesContact = phonesContact.join();\n    const genderContact = this._viewContact.GENDER_CONTACT.value;\n    const data = { _id : idContact, photo : photoContact, name : nameContact, surname : surnameContact, age : ageContact, phone : phonesContact, gender : genderContact };\n    return data;\n} \n}"],"file":"view.contact.controller.js"}